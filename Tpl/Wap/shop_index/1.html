<!doctype html>
<html>

	<head>
		<title>{$_SESSION['WAP']['shopset']['name']}</title>
		<meta charset="utf-8" />
		<!--页面优化-->
		<meta name="MobileOptimized" content="320">
		<!--默认宽度320-->
		<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<!--viewport 等比 不缩放-->
		<meta http-equiv="cleartype" content="on">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<!--删除苹果菜单-->
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
		<!--默认颜色-->
		<meta name="apple-mobile-web-app-title" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<!--加载全部后 显示-->
		<meta content="telephone=no" name="format-detection" />
		<!--不识别电话-->
		<meta content="email=no" name="format-detection" />
		<!--Wap前端GMU样式-->
		<link rel="stylesheet" type="text/css" href="__PUBLIC__/wap/gmu/gmu.css" />
		<link rel="stylesheet" type="text/css" href="__PUBLIC__/wap/css/fxstyle.css" />
		<link rel="stylesheet" type="text/css" href="__PUBLIC__/wap/css/Joel-frame.css" />
		<link rel="stylesheet" type="text/css" href="__PUBLIC__/wap/css/joelslider.css" />
		<!--组件依赖js begin-->
		<script type="text/javascript" src="__PUBLIC__/wap/gmu/zepto.min.js"></script>
		<script type="text/javascript" src="__PUBLIC__/wap/gmu/gmu.min.js"></script>
		<script type="text/javascript" src="__PUBLIC__/wap/js/swipe.js"></script>
		<script type="text/javascript" src="__PUBLIC__/wap/gmu/Joel-basegmu.js"></script>
		<script type="text/javascript" src="__PUBLIC__/wap/js/joelslider.min.js"></script>
		<!--组件依赖js end-->

		<style type="text/css">
			.search {
				width: 70%;
				height: 30px;
				margin: 9px 10px 0 0;
			}
			.searchtxt {
				width: 80%;
			}
			.searchtxt input {
				width: 100%;
				border: none;
				height: 35px;
				font-size: 14px;
				line-height: 35px;
				padding-left: 5px;
				height: 35px;
				-webkit-user-select: text;
				display: inline-block;
				vertical-align: middle;
			}
			.btn {
				width: 100%;
				overflow: hidden;
			}
			.btn a {
				width: 20%;
				text-align: center;
				float: left;
				margin-left: 4%;
			}
			.btn a p {
				color: #292929;
				line-height: 20px;
				font-size: 0.8em;
			}
			.commodity {
				width: 100%;
				margin: 0 auto;
				margin-top: 10px;
				background: #f0f0f0;
			}
			.goodtitle {
				color: #292929;
				font-size: 14px;
				margin: 2px 10px 10px 3%;
				line-height: 2.5em;
				border-bottom: solid 1px #ccc;
				border-left: .5em solid #ccc;
				text-indent: .5em;
				background-color: #fff;
			}
			.goodtitle a{
				font-size: 12px;
				color: #292929;
			}
			.goodtitle span:last-child {
				margin-right: 2px;
				float: right;
			}
			.good ul {
				width: 100%;
			}
			.good ul li {
				float: left;
				width: 45.5%;
				background: #FFFFFF;
				border: 0px solid #e7e7e7;
				text-align: center;
				margin-left: 3%;
				margin-bottom: 10px;
				border-radius: 5px;
			}
			.good ul li a {
				color: black;
			}
			.good ul li .gpic {
				width:100%;
				/*height: 150px;*/
				overflow: hidden;
			}
			.good ul li .gname {
				line-height: 1.2em;
				height: 1.2em;
				overflow: hidden;
				margin: 10px 0;
			}
			.titleimg {
				margin-top: 10px;
			}
			#Joel-slider2 li a {
				width: 20%;
				display: block;
				float: left;
			}
			.swipe {
				overflow: hidden;
				visibility: hidden;
				position: relative;
			}
			.swipe-wrap {
				overflow: hidden;
				position: relative;
			}
			.swipe-wrap > div {
				float: left;
				width: 100%;
				position: relative;
			}
			.btn a p:first-child {
				width: 70%;
				margin: 0 auto;
			}
			.good {
				font-size: 0.8em;
			}
			.wp96 {
				background-color: black;
				width: 100%;
			}
			.p-pitemprice,
			.p-pitemsl {
				text-align: left;
				margin: 0 10px;
			}
			.p-pitemprice span,
			.p-pitemsl span {
				/*margin: 0 10px;*/
				color: #cccccc;
			}
			
			.p-pitemprice span:last-child,
			.p-pitemsl span:last-child {
				/*margin: 0 10px;*/
				float:right;
				color: #cccccc;
			}
			.p-pitemprice font {
				font-size: 1.2em;
			}
			nav #position {
			    text-align: center;
			    list-style: none;
			    margin: 0;
			    padding: 0;
			}
			nav #position li {
			    display: inline-block;
			    width: 10px;
			    height: 10px;
			    border-radius: 10px;
			    border: 1px solid #ccc;
			    margin: 0 2px;
			}
			nav #position li.on{
				box-shadow:inset 0 1px 3px -1px green,0 1px 2px rgba(0,0,0,.5);
				background-color:green;
				background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#1293dc),color-stop(100%,#0f6297));
				background-image:-webkit-linear-gradient(top,green,#0f6297);
				background-image:-moz-linear-gradient(top,#1293dc,#0f6297);
				background-image:-ms-linear-gradient(top,#1293dc,#0f6297);
				background-image:-o-linear-gradient(top,#1293dc,#0f6297);
				background-image:linear-gradient(top,#1293dc,#0f6297);
			}
		</style>
	</head>

	<body>
		<div id="J-wrap">
			<!--顶部导航-->
			<include file="./Tpl/Wap/shop_header.html" />

			<div id="Joel-wrap-main">
				<div id="Joel-slider">
					<ul>
						<foreach name="indexalbum" item="vo">
							<li>
								<a href="{$vo.url}"><img src="{$vo.imgurl}"></a>
							</li>
						</foreach>
					</ul>
					<div class="dot">
						<foreach name="indexalbum" item="vo">
							<span></span>
						</foreach>
					</div>
				</div>

				<div id='slider' class='swipe' style="margin-top: 10px;">
					<div class='swipe-wrap'>
						<div class="btn">
							<a href="#" id="J-menu-start">
								<p><img src="__PUBLIC__/wap/img/btn_03.png" width="50%" /></p>
								<p class="f15">更多商品</p>
							</a>
							<volist name="indexcache" id="v" offset="0" length='3'>
								<a href="{:u('Shop/label',array('id'=>$v['id']))}">
									<p><img src="{$v.limgurl}" width="50%" /></p>
									<p class="f15">{$v.name}</p>
								</a>
							</volist>
							
							<!--<a href="{:u('Shop/label',array('id'=>$v['id']))}">
								<p><img src="__PUBLIC__/wap/img/btn_07.png" width="50%" /></p>
								<p class="f15">精选商品</p>
							</a>
							<a href="{:u('Shop/label',array('id'=>$v['id']))}">
								<p><img src="__PUBLIC__/wap/img/btn_09.png" width="50%" /></p>
								<p class="f15">特惠商品</p>
							</a>-->
							<br style="clear: both;" />
						</div>
						<div class="btn">
							<volist name="indexcache" id="v" offset="3" length='2'>
								<a href="{:u('Shop/label',array('id'=>$v['id']))}">
									<p><img src="{$v.limgurl}" width="50%" /></p>
									<p class="f15">{$v.name}</p>
								</a>
							</volist>
							<a href="/wap/vip/card">
								<p><img src="__PUBLIC__/wap/img/btn_01.png" width="50%" /></p>
								<p class="f15">优惠券</p>
							</a>
							<a href="{:U('Vip/favlist')}">
								<p><img src="__PUBLIC__/wap/img/btn_02.png" width="50%" /></p>
								<p class="f15">收藏夹</p>
							</a>							
							<br style="clear: both;" />
						</div>
					</div>
				</div>
				<nav>
				    <ul id="position">
				      <li class="on"></li>
				      <li class=""></li>
				    </ul>
				</nav>
				<div class="commodity">
					<foreach name="indexcache" item="vo" key='i'>
						<notempty name="vo.goods">
							<div class="good">
								<!-- 作者：郑伊凡 2016-2-5 母版本 增加链接 -->
								<p><a href="{:u('Shop/label',array('id'=>$vo['id']))}"><img src="{$vo.imgurl}" width="100%" /></a></p>
								<!-- 作者：郑伊凡 2016-2-5 母版本 增加链接 -->
								<p class="goodtitle">{$vo.name} <span><neq name="$vo.count" value="0"><a href="{:u('Shop/label',array('id'=>$vo['id']))}">更多商品&gt;&gt;</a></neq></span></p>
								<ul>
									<foreach name="vo.goods" item="vv">
										<li><a href="{:U('Wap/Shop/goods',array('id'=>$vv['id']))}">
											<p class="marbottom10 gpic"><img src="{$vv.imgurl}" onclick="tiao({$vv.id})" width="71.5%" /></p>
											<p class="f13 cor1 gname">{$vv.name}</p>
											<p class="p-pitemprice"><span><font color="red">￥{$vv.price}</font></span><span><del>￥{$vv.oprice}</del></span></p>
											<p class="p-pitemsl"><span>已售：<eq name="vv['issells']" value="1">{$vv.dissells}<else/>{$vv.sells}</eq></span><span>&nbsp剩余:{$vv.num}</span></p>
											</a>
										</li>
									</foreach>
								</ul>
								<div style="clear:both"></div>
							</div>
						</notempty>
					</foreach>

				</div>
				<!--J-wrapmain-->
			</div>
			<!-- 底部导航 -->
			<include file="./Tpl/Wap/shop_footer.html" />
			<!-- /底部导航 -->
		</div>
		<!--左侧导航-->
		<include file="./Tpl/Wap/shop_leftnav.html" />
		<!--左侧导航-->
		<!--轮播封装-->
		<script type="text/javascript">
			Zepto(function($) {
				$(".commodity li p img").css("height",$(".commodity li p img").css("width"));
				$('#Joel-slider').swipeSlide({
					autoSwipe: true,
					lazyLoad: false,
					speed: 3000
				}, function(i) {
					$('#Joel-slider .dot').children().eq(i).addClass('cur').siblings().removeClass('cur');
				});
				//				var JH=$('#J-wrap-header');
				//				var JM=$('#J-menu');
				//初始化菜单
				$('#J-wrap-left').panel({
					contentWrap: $('#Joel-wrap-main'),
					beforeopen: function() {
						//var y=$(JH).offset().top;
						//$(JM).css('margin-top',y+'px');
					}
				});
				//菜单呼出
				$('#J-leftnav-switch').on('click', function() {
					$('#J-wrap-left').panel('toggle', 'push', 'left');
					return false;
				});
				$("#J-menu-start").on('click', function() {
					//$('#J-leftnav-switch').trigger('click');
					$('#J-wrap-left').panel('toggle', 'push', 'left');
					return false;
				});
				$("#searchbtn").on('tap', function() {
					if (!$('#searchkey').val()) {
						alert('请输入关键词！');
						return false;
					}
					$("#searchform").submit();
					return false;
				});
			});
			window.mySwipe = new Swipe(document.getElementById('slider'), {
				/*startSlide: 0,*/
				speed: 400,
				auto: false,
				continuous: false,
				disableScroll: false,
				stopPropagation: true,
				/*callback: function(index, elem) {},*/
				callback: function(pos) {
			      var i = bullets.length;
			      while (i--) {
			        bullets[i].className = ' ';
			      }
			      bullets[pos].className = 'on';			
			  },
				transitionEnd: function(index, elem) {}
			});
			var bullets = document.getElementById('position').getElementsByTagName('li');
			function tiao(id)
			{
				location.href="goods/id/"+id;
			}
		</script>
		<!--Wap框架JS封装-->
		<!--<script type="text/javascript">
			Zepto(function($) {
				$('#J-getmore').on('click', function() {
					$(this).html('正在努力为您加载...').prop('disabled', true);
					var nowpage = $(this).data('page');
					var nextpage = nowpage + 1;
					$.ajax({
						type: "post",
						url: "{:U('Wap/Shop/indexMore')}",
						dataType: 'json',
						data: {
							'page': nowpage
						},
						success: function(info) {
							if (info.status) {
								$('#J-getmore').data('page', nextpage).html('加载更多商品').prop('disabled', false);
								$('.p-prolist').append(info.result);
							} else {
								$('#J-getmore').hide();
								Joel_gmuMsg(info.msg);
							}
						},
						error: function(xh, obj) {
							$('#J-getmore').data('page', nextpage).html('加载更多商品').prop('disabled', false);
							Joel_gmuMsg('通讯失败,请重新尝试！');
						}
					});
					return false;
				});
			});
		</script>-->

		<!--<include file="./Tpl/Wap/shop_share.html" />-->
		<!--新版分享特效-->
		<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
		<script>
			var share_url = "{$_SESSION['WAP']['shopset']['url']}/Wap/Shop/index/ppid/{$_SESSION['WAP']['vipid']}/";
			var share_title="{$_SESSION['WAP']['shopset']['name']}";
			var share_content="{$_SESSION['WAP']['shopset']['summary']}";
			var share_img="{$_SESSION['WAP']['shopset']['url']}{$_SESSION['WAP']['shopset']['sharepic']}";
			
		  wx.config({
		      debug: false,
		      appId: "{$jsapi['appId']}",
			  timestamp: "{$jsapi['timestamp']}",
			  nonceStr: "{$jsapi['nonceStr']}",
			  signature: "{$jsapi['signature']}",
		      jsApiList: [
		        'checkJsApi',
		        'onMenuShareTimeline',
		        'onMenuShareAppMessage',
		        'onMenuShareQQ',
		        'onMenuShareWeibo',
		        'hideMenuItems',
		        'showMenuItems',
		        'hideAllNonBaseMenuItem',
		        'showAllNonBaseMenuItem',
		//      'translateVoice',
		//      'startRecord',
		//      'stopRecord',
		//      'onRecordEnd',
		//      'playVoice',
		//      'pauseVoice',
		//      'stopVoice',
		//      'uploadVoice',
		//      'downloadVoice',
		//      'chooseImage',
		//      'previewImage',
		//      'uploadImage',
		//      'downloadImage',
		//      'getNetworkType',
		//      'openLocation',
		//      'getLocation',
		//      'hideOptionMenu',
		//      'showOptionMenu',
		//      'closeWindow',
		//      'scanQRCode',
		//      'chooseWXPay',
		//      'openProductSpecificView',
		//      'addCard',
		//      'chooseCard',
		//      'openCard'
		      ]
		  });
		  
		  wx.ready(function () {
			  	//开启菜单
			  	wx.showOptionMenu();
			  	//隐藏菜单
			  	//wx.hideOptionMenu();
			    //分享给朋友
			    wx.onMenuShareAppMessage({
			      title: share_title,
			      desc: share_content,
			      link: share_url,
			      imgUrl: share_img,
			      trigger: function (res) {
			        //alert('用户点击发送给朋友');
			      },
			      success: function (res) {
			        //alert('已分享');
			      },
			      cancel: function (res) {
			        //alert('已取消');
			      },
			      fail: function (res) {
			        //alert(JSON.stringify(res));
			      }
			    });
			    //分享到朋友圈
			    wx.onMenuShareTimeline({
			      title: share_title,
			      link: share_url,
			      imgUrl: share_img,
			      trigger: function (res) {
			        //alert('用户点击分享到朋友圈');
			      },
			      success: function (res) {
			        //alert('已分享');
			      },
			      cancel: function (res) {
			        //alert('已取消');
			      },
			      fail: function (res) {
			        //alert(JSON.stringify(res));
			      }
			    });
			    //分享到QQ
			    wx.onMenuShareQQ({
			      title: share_title,
			      desc: share_content,
			      link: share_url,
			      imgUrl: share_img,
			      trigger: function (res) {
			        //alert('用户点击分享到QQ');
			      },
			      complete: function (res) {
			        //alert(JSON.stringify(res));
			      },
			      success: function (res) {
			        //alert('已分享');
			      },
			      cancel: function (res) {
			        //alert('已取消');
			      },
			      fail: function (res) {
			        //alert(JSON.stringify(res));
			      }
			    });
		  });
		</script>
	</body>

</html>