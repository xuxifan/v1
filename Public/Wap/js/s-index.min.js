function Home(){this.config={};if(arguments[0]!=undefined&&arguments[0] instanceof Object){Util.extend(this.config,arguments[0])}else{}this._init()}Home.prototype={_init:function(){var that=this;Constants.DIALOG.show();Constants.DIALOG.hide();shareFn();Util.calcHeight(this.config.wheel,375,117,1);Util.calcHeight(this.config.gold,140,174,0.44);this._wheelInit();this._goldInit();this._couponInit();this._classifyInit();this._modulesInit();this._eventInit();diff_platform({android:function(){addClass(law,"law-pad")},ios:function(){}});sys();load_page("back_index_top");var shareDataI={share_url:"http://pay.xiaojukeji.com/api/v2/weixinapi?page=middlepage&pageEntry=1&channel2=6",share_icon_url:"http://static.diditaxi.com.cn/activity/img-mall/share.jpg",share_img_url:"http://static.diditaxi.com.cn/activity/img-mall/share.jpg",share_title:"有滴币享福利，任性兑换不花钱",share_content:"DiDi商城天天上新品：水果零食、休闲购物、生活娱乐、鲜花礼品，好礼兑不停",share_from:"滴滴出行"};var shareDataJ={share_url:"http://pay.xiaojukeji.com/api/v2/weixinapi?page=middlepage&pageEntry=2&channel2=7",share_icon_url:"http://static.diditaxi.com.cn/activity/img-mall/share.jpg",share_img_url:"http://static.diditaxi.com.cn/activity/img-mall/share.jpg",share_title:"有滴币享福利，任性兑换不花钱",share_content:"DiDi商城天天上新品：水果零食、休闲购物、生活娱乐、鲜花礼品，好礼兑不停",share_from:"滴滴出行"};if(window.didi){didi.initShare(shareDataI,function(){Util.addMallLog("addShareLog",Util.getUrlParams(),{"shareTo":1,"shareType":1})},function(){Util.addMallLog("addShareLog",Util.getUrlParams(),{"shareTo":2,"shareType":1})},shareDataJ)}Util.addMallLog("addAccessLog",Util.getUrlParams())},_wheelInit:function(){var C=this.config;if(C.errno==0){Constants.DIALOG.show();var html=template(C.wheelTemplateId,C.wheel_data());C.wheel.innerHTML=html;var startX,startY,moveEndX,moveEndY;C.wheel.addEventListener("touchstart",function(ev){ev.preventDefault();startX=ev.changedTouches[0].pageX;startY=ev.changedTouches[0].pageY},false);C.wheel.addEventListener("touchmove",function(ev){ev.preventDefault();moveEndX=ev.changedTouches[0].pageX;moveEndY=ev.changedTouches[0].pageY;X=moveEndX-startX;Y=moveEndY-startY;if(Math.abs(X)>=20||Math.abs(Y)>=20){ev.target.setAttribute("moved","true")}},false);C.wheel.addEventListener("touchend",function(ev){ev.preventDefault();if(ev.target.getAttribute("moved")=="true"){ev.target.setAttribute("moved","false");return}if(ev.target.dataset.id==0){Util.addMallLog("addPvLog",Util.getUrlParams(),{"entry":5,"topicUrl":ev.target.getAttribute("href")})}link(ev.target,function(){Constants.DIALOG.show()});ev.target.setAttribute("moved","false")},false);if(C.wheel.getElementsByTagName("img").length>0){C.wheel.getElementsByTagName("img")[0].onload=function(){Constants.DIALOG.hide()}}else{C.wheel.style.display="none";Constants.DIALOG.hide()}var indicator=Util.getNextElement(C.wheel);var wItem=C.wheel_data().wheel_item;if(wItem&&wItem.length>0){var indLength=wItem.length;for(var i=0;i<indLength;i++){var indNew=Constants.DOC.createElement("span");indicator.appendChild(indNew)}indicator.children[0].className="on"}asyncLoadJS("//static.xiaojukeji.com/activity/js/shop/s-wheel.js",function(){if(typeof C.wheel==="function"){C.wheel()}})}else{if(C.errno==3008){}else{dd.dialog.alert({icon:{url:"//static.xiaojukeji.com/activity/img-mall/error.png",width:"7px",height:"42px"},tip:C.errmsg,title:"",btn:{val:"我知道啦",handler:function(ev){}}})}}},_goldInit:function(){var C=this.config;ajax({method:"GET",url:$root+"/"+Util.redirectPage("goldArea"),succFunc:function(data){var da=txtToJson(data);if(da.ret.code==0){var gold_json=txtToJson(da.data);if(gold_json.length&&gold_json.length>0){var gold_data_fir=gold_json[0],gold_data_sec=gold_json[1],gold_data_thi=gold_json[2];var html_fir=template("gold_list_fir",gold_data_fir);C.gold_left.innerHTML=html_fir;if(gold_data_sec){var html_sec=template("gold_list_sec",gold_data_sec);C.gold_right.innerHTML+=html_sec}if(gold_data_thi){var html_thi=template("gold_list_sec",gold_data_thi);C.gold_right.innerHTML+=html_thi}load_img(C.gold)}else{C.gold.style.display="none"}}else{C.gold.style.display="none"}},failFunc:function(){C.gold.style.display="none"}})},_classifyInit:function(){var C=this.config;var classify_data={};if(C.classify_json().length&&C.classify_json().length>0){classify_data.classify_item=C.classify_json();var html=template("classify_list",classify_data);C.classify.innerHTML=html;var aImg=C.classify.getElementsByTagName("img");for(var i=0;i<aImg.length;i++){(function(index){aImg[index].onload=function(){aImg[index].style.display="block"}})(i)}}else{C.classify.style.display="none"}},_couponInit:function(){var C=this.config;var coupon_data={};coupon_data.link=Util.redirectPage("coupon",{"entry":4});coupon_data.imgUrl=$root+"/img/coupon_banner_index.jpg";var html=template("coupon_list",coupon_data);C.coupon.innerHTML=html},_modulesInit:function(){var C=this.config;ajax({method:"GET",url:$root+"/"+Util.redirectPage("topicArea"),succFunc:function(data){var da=txtToJson(data);if(da.ret.code==0){var modules_json=txtToJson(da.data);
    if(modules_json.length&&modules_json.length>0){for(var i=0;i<modules_json.length;i++){if(modules_json[i].items.length==0){continue}else{var modules_data=modules_json[i];var html=template("modules_list",modules_data);C.modules.innerHTML+=html}}load_img(C.modules)}else{C.modules.style.display="none"}}else{C.modules.style.display="none"}},failFunc:function(){C.modules.style.display="none"}})},_eventInit:function(){var that=this,C=this.config;window.addEventListener("popstate",function(ev){Constants.DIALOG.hide();that._countData()},false);window.onscroll=window.onresize=function(){load_img(that.config.modules)};C.count.addEventListener("click",function(ev){Constants.DIALOG.show();location.href=Util.redirectPage("count")},false);C.record.addEventListener("click",function(ev){ev.preventDefault();Constants.DIALOG.show();location.href=Util.redirectPage("record")},false);touch(C.goods,function(ev){var back_index_top=Constants.DOC.body.scrollTop||Constants.DOC.documentElement.scrollTop;localStorage.back_index_top=back_index_top;if(ev.target.dataset.id==0){Util.addMallLog("addPvLog",Util.getUrlParams(),{"entry":5,"topicUrl":ev.target.getAttribute("href")})}link(ev.target,function(){Constants.DIALOG.show()})},false);touch(C.law,function(ev){Constants.DIALOG.show();location.href="law.htm"},false)},_countData:function(){ajax({method:"GET",url:$root+"/getCount.htm",succFunc:function(data){var da=txtToJson(data);if(da.ret.code==0){var data_json=txtToJson(da.data);this.config.myCount.innerHTML=data_json.count}else{}},failFunc:function(){}})}};